# Advanced Substructure Detection Demo
# Showcases PINN's ability to identify small-scale dark matter perturbations
# Key innovation for ISEF project

name: "Dark Matter Substructure Detection"
description: "Machine learning-based detection of sub-percent mass perturbations"

lens:
  model: "SIE"  # Singular Isothermal Ellipsoid
  mass: 5.0e11  # solar masses
  z: 0.2
  ellipticity: 0.4
  position_angle: 60.0
  center_x: 0.0
  center_y: 0.0

# Multiple substructures for challenging test
substructure:
  enabled: true
  components:
    - model: "NFW"
      mass: 5.0e9   # 1% of main lens
      concentration: 15.0
      position_x: 0.8
      position_y: 0.6
      z: 0.2
    - model: "NFW"
      mass: 3.0e9
      concentration: 12.0
      position_x: -0.9
      position_y: -0.5
      z: 0.2

source:
  z: 1.0
  position_x: 0.15
  position_y: 0.1
  magnitude: 21.0
  radius: 0.2  # extended source for better sensitivity

observation:
  pixel_scale: 0.04
  fov_size: 256
  noise_level: 0.008  # low noise for substructure detection

psf:
  type: "HST_ACS"
  fwhm: 0.09

ray_tracing:
  mode: "thin_lens"
  grid_resolution: 512
  adaptive_refinement: true

cosmology:
  H0: 70.0
  Om0: 0.3
  Ode0: 0.7

data:
  source_image: "builtin:substructure_test"
  use_real_data: false

analysis:
  run_pinn_inference: true
  uncertainty_quantification: true
  detect_substructure: true
  bayesian_uq: true  # Full Bayesian uncertainty
  model_comparison: true
  output_convergence_map: true
  output_residuals: true
